<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NutriTracker - Sign In</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="layout">
    <div class="shell" style="max-width: 520px;">
      <div class="auth-hero">
        <div class="app-badge" aria-hidden="true">ðŸ¥—</div>
        <h1 class="h1" style="text-align:center;">Welcome Back</h1>
        <p class="muted" style="text-align:center;">Track your nutrition journey</p>
      </div>

      <div class="card auth-card">
        <div class="card-header">
          <div class="tabs" role="tablist">
            <button class="tab active" id="tabLogin" type="button" role="tab" aria-selected="true">Sign In</button>
            <button class="tab" id="tabRegister" type="button" role="tab" aria-selected="false">Sign Up</button>
          </div>
        </div>

        <div class="card-body">
          <!-- LOGIN -->
          <form id="loginForm" class="stack" autocomplete="on">
            <div>
              <label class="label" for="login_email">Email</label>
              <input class="input" id="login_email" type="email" placeholder="you@example.com" required />
            </div>
            <div>
              <label class="label" for="login_password">Password</label>
              <input class="input" id="login_password" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" required />
            </div>
            <button class="btn btn-wide" type="submit">Sign In</button>
          </form>

          <!-- REGISTER -->
          <div id="registerRedirect" class="stack hidden">
            <p class="muted" style="margin:0;">Sign up happens on the registration page, where you'll also create your profile.</p>
            <a class="btn btn-wide" href="register.html">Go to Sign Up</a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="auth.js"></script>
  <script src="api.js"></script>
  <script>
    // Tabs
    const tabLogin = document.getElementById('tabLogin');
    const tabRegister = document.getElementById('tabRegister');
    const loginForm = document.getElementById('loginForm');
    const registerRedirect = document.getElementById('registerRedirect');

    function setTab(which) {
      const isLogin = which === 'login';
      tabLogin.classList.toggle('active', isLogin);
      tabRegister.classList.toggle('active', !isLogin);
      tabLogin.setAttribute('aria-selected', String(isLogin));
      tabRegister.setAttribute('aria-selected', String(!isLogin));
      loginForm.classList.toggle('hidden', !isLogin);
      registerRedirect.classList.toggle('hidden', isLogin);
    }

    tabLogin.addEventListener('click', () => setTab('login'));
    tabRegister.addEventListener('click', () => window.location.href = 'register.html');

    // API calls (same logic as your original file)
    async function login(e) {
      e.preventDefault();
      const email = login_email.value;
      const password = login_password.value;

      const res = await fetch('http://localhost:3000/api/auth/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email, password })
      });

      if (!res.ok) return alert('Login failed');
      const data = await res.json();
      setToken(data.token);
      window.location.href = 'dashboard.html';
    }

    loginForm.addEventListener('submit', login);
  </script>
</body>
</html>
